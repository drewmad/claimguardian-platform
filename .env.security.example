# ClaimGuardian Security-Enhanced Environment Variables
# Copy this to .env.local and fill in your values

# ============================================
# CORE SUPABASE (Required)
# ============================================
NEXT_PUBLIC_SUPABASE_URL=https://[PROJECT_ID].supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=[YOUR_ANON_KEY]
SUPABASE_SERVICE_ROLE_KEY=[YOUR_SERVICE_ROLE_KEY]
SUPABASE_JWT_SECRET=[YOUR_JWT_SECRET]

# ============================================
# AI SERVICES (Required for AI features)
# ============================================
# Rotate these keys every 30 days
OPENAI_API_KEY=sk-[YOUR_KEY]  # Last rotated: YYYY-MM-DD
GEMINI_API_KEY=[YOUR_KEY]      # Last rotated: YYYY-MM-DD

# ============================================
# EMAIL SERVICES (Required for notifications)
# ============================================
# Rotate every 90 days
RESEND_API_KEY=re_[YOUR_KEY]   # Last rotated: YYYY-MM-DD
RESEND_FROM_EMAIL=noreply@claimguardianai.com

# ============================================
# MONITORING & ANALYTICS (Recommended)
# ============================================
# Rotate every 90 days
SENTRY_AUTH_TOKEN=[YOUR_TOKEN]  # Last rotated: YYYY-MM-DD
NEXT_PUBLIC_SENTRY_DSN=https://[YOUR_DSN]@sentry.io/[PROJECT]
SENTRY_ORG=[YOUR_ORG]
SENTRY_PROJECT=[YOUR_PROJECT]

# ============================================
# EXTERNAL APIS (Optional)
# ============================================
# Public keys - rotate every 180 days
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=[YOUR_KEY]  # Restrict to domains!
GOOGLE_PAGESPEED_API_KEY=[YOUR_KEY]         # For performance monitoring

# ============================================
# SECURITY SETTINGS (Required)
# ============================================
# Session configuration
SESSION_SECRET=[GENERATE_WITH: openssl rand -base64 32]
SESSION_MAX_AGE=3600  # 1 hour in seconds

# Rate limiting
RATE_LIMIT_WINDOW_MS=60000      # 1 minute
RATE_LIMIT_MAX_REQUESTS=30      # Per window

# CORS allowed origins (comma-separated)
ALLOWED_ORIGINS=https://claimguardianai.com,https://app.claimguardianai.com

# Content Security Policy
CSP_REPORT_URI=https://claimguardianai.report-uri.com/r/d/csp/enforce

# ============================================
# DATABASE SECURITY (Required)
# ============================================
# Connection pooling
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_STATEMENT_TIMEOUT=30000  # 30 seconds

# Encryption keys (rotate every 90 days)
ENCRYPTION_KEY=[GENERATE_WITH: openssl rand -base64 32]
ENCRYPTION_KEY_PREVIOUS=[PREVIOUS_KEY_FOR_ROTATION]

# ============================================
# FEATURE FLAGS (Optional)
# ============================================
ENABLE_LEAKED_PASSWORD_CHECK=true
ENABLE_2FA_ENFORCEMENT=false
ENABLE_AUDIT_LOGGING=true
ENABLE_RATE_LIMITING=true

# ============================================
# DEVELOPMENT ONLY (Never in production!)
# ============================================
# NODE_ENV=development
# NEXT_PUBLIC_DEBUG_MODE=false
# DISABLE_AUTH_CHECKS=false

# ============================================
# CI/CD SECRETS (GitHub Actions)
# ============================================
# Set these in GitHub Secrets, not in .env files:
# - VERCEL_TOKEN
# - VERCEL_ORG_ID
# - VERCEL_PROJECT_ID
# - TURBO_TOKEN
# - TURBO_TEAM
# - SLACK_WEBHOOK

# ============================================
# SECURITY NOTES
# ============================================
# 1. NEVER commit this file with real values
# 2. Use strong, unique passwords for all keys
# 3. Rotate keys according to the schedule
# 4. Restrict API keys by IP/domain when possible
# 5. Use different keys for dev/staging/production
# 6. Enable 2FA on all service accounts
# 7. Monitor key usage in provider dashboards
# 8. Revoke old keys 24h after rotation

# Key Generation Commands:
# - Random secret: openssl rand -base64 32
# - UUID: uuidgen (macOS) or uuid (Linux)
# - Bcrypt hash: htpasswd -bnBC 10 "" "password" | tr -d ':\n'

# Validation:
# Run: source .env.local && ./scripts/.keys/verify-keys.sh
